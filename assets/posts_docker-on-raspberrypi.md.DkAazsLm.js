import{_ as e,b as i,o as a,a5 as t}from"./chunks/framework.CAaOUjTN.js";const r="/assets/2020-05-31T211438.QhxPIx0p.png",p="/assets/2020-05-31T211735.fjqakdM5.png",n="/assets/2020-05-31T212029.D03igIka.png",o="/assets/2020-05-31T214154.BUBgvVu-.png",l="/assets/2020-05-31T214257.C_FZEDus.png",c="/assets/2020-05-31T220348.BG7yYL2o.png",h="/assets/2020-05-31T215710.ByWa4i2t.png",y=JSON.parse('{"title":"树莓派之 Docker","description":"","frontmatter":{"title":"树莓派之 Docker","date":"2020-05-31T05:06:43.000Z","tags":["Docker","Linux"],"license":"CC BY-NC 4.0","read":{"text":"4 min read","minutes":3.635,"time":218100,"words":727}},"headers":[{"level":2,"title":"路由器刷固件","slug":"路由器刷固件","link":"#路由器刷固件","children":[]},{"level":2,"title":"树莓派 Docker 服务","slug":"树莓派-docker-服务","link":"#树莓派-docker-服务","children":[]},{"level":2,"title":"部署 Docker 服务","slug":"部署-docker-服务","link":"#部署-docker-服务","children":[]},{"level":2,"title":"最终效果","slug":"最终效果","link":"#最终效果","children":[]}],"relativePath":"posts/docker-on-raspberrypi.md","filePath":"posts/docker-on-raspberrypi.md"}'),d={name:"posts/docker-on-raspberrypi.md"};function k(g,s,u,f,m,b){return a(),i("div",null,s[0]||(s[0]=[t('<p>一直都想部署一个局域网服务，保存自己下载的电影、图片等等。空闲的时候，还能挂着下载东西。</p><p>一直没空，刚好这个周末有空，就尝试在树莓派 4 上面部署 Docker 服务。配合路由器修改 hosts 用着还不错。</p><p>所需硬件：</p><ul><li>树莓派 4B 1GB x1</li><li>斐讯 K2 路由器 x1</li><li>一台电脑（笔记本/台式机都行）</li></ul><h2 id="路由器刷固件" tabindex="-1">路由器刷固件 <a class="header-anchor" href="#路由器刷固件" aria-label="Permalink to &quot;路由器刷固件&quot;">​</a></h2><p>路由器刷 Padavan 固件(默认用户名/密码是: admin/admin)，可以刷其它固件，只要又绑定 mac 地址功能，和自定义 hosts 功能即可。</p><figure><img src="'+r+'" alt="2020-05-31T211438" tabindex="0" loading="lazy"><figcaption>2020-05-31T211438</figcaption></figure><p>树莓派的地址是 192.168.123.26, 记住后面有用</p><figure><img src="'+p+'" alt="2020-05-31T211735" tabindex="0" loading="lazy"><figcaption>2020-05-31T211735</figcaption></figure><p>在「内部网络 -&gt; DHCP 配置」中绑定 MAC 地址，以及设置 hosts，到这里，路由器的配置就结束啦。重头戏还是在树莓派里面。</p><h2 id="树莓派-docker-服务" tabindex="-1">树莓派 Docker 服务 <a class="header-anchor" href="#树莓派-docker-服务" aria-label="Permalink to &quot;树莓派 Docker 服务&quot;">​</a></h2><p>树莓派刷入官方固件</p><p>下载地址：<a href="https://www.raspberrypi.org/downloads/raspbian/" target="_blank" rel="noreferrer">https://www.raspberrypi.org/downloads/raspbian/</a></p><p>建议下载 recommend 版本，有 GUI 好用一点点。我就用联了个网，后面基本也没用过 GUI 😃</p><p>安装好之后，联入路由器，开启 ssh 登陆，然后就可以在电脑上用 ssh 工具登录树莓派。</p><figure><img src="'+n+`" alt="2020-05-31T212029" tabindex="0" loading="lazy"><figcaption>2020-05-31T212029</figcaption></figure><p>准备工作，由于在国内，安装软件，以及拉取镜像等操作都可能因为网络原因失败，所以第一步就是替换软件源地址</p><ol><li>替换树莓派 Debian 软件源，替换成清华的源地址</li></ol><p>修改方式参考：<a href="https://mirror.tuna.tsinghua.edu.cn/help/raspbian/" target="_blank" rel="noreferrer">https://mirror.tuna.tsinghua.edu.cn/help/raspbian/</a></p><ol start="2"><li>安装 Docker</li></ol><p>使用官网的安装脚本：<a href="https://github.com/docker/docker-install" target="_blank" rel="noreferrer">https://github.com/docker/docker-install</a></p><p>国内可用阿里云的镜像地址来安装：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-dark vitesse-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#59873A;">curl</span><span style="--shiki-dark:#C99076;--shiki-light:#A65E2B;"> -fsSL</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> https://get.docker.com</span><span style="--shiki-dark:#C99076;--shiki-light:#A65E2B;"> -o</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> get-docker.sh</span></span>
<span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#59873A;">sh</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> get-docker.sh</span><span style="--shiki-dark:#C99076;--shiki-light:#A65E2B;"> --mirror</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> Aliyun</span></span></code></pre></div><p>安装完之后，再安装 Docker-Compose：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-dark vitesse-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#59873A;">sudo</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> apt</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> update</span></span>
<span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#59873A;">sudo</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> apt</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> install</span><span style="--shiki-dark:#C98A7D;--shiki-light:#B56959;"> docker-compose</span></span></code></pre></div><p>安装完之后，记得修改 Docker Hub 的镜像地址：</p><p>修改成中科大的地址，修改方式：<a href="https://mirrors.ustc.edu.cn/help/dockerhub.html" target="_blank" rel="noreferrer">https://mirrors.ustc.edu.cn/help/dockerhub.html</a></p><p>到此，Docker 环境就安装好啦。</p><h2 id="部署-docker-服务" tabindex="-1">部署 Docker 服务 <a class="header-anchor" href="#部署-docker-服务" aria-label="Permalink to &quot;部署 Docker 服务&quot;">​</a></h2><p>推荐使用 Docker-compose 来部署服务，因为 docker-compose 可以把配置写到文件中，不用每次启动都输入一遍配置。</p><p>可选在树莓派上安装 Nginx 反向代理服务，如果不安装在树莓派上，可以在 Docker 中运行 Nginx，只不过，因此 Docker 中其它服务都必须在同一 network 上。</p><p>Docker 相关配置参考：<a href="https://github.com/cwxyz007/Dockerfiles" target="_blank" rel="noreferrer">https://github.com/cwxyz007/Dockerfiles</a></p><h2 id="最终效果" tabindex="-1">最终效果 <a class="header-anchor" href="#最终效果" aria-label="Permalink to &quot;最终效果&quot;">​</a></h2><p>以下服务只能在局域网里面访问，而且因为 Nginx 反向代理加上路由器 hosts 的原因，需要正确的域名才能访问到对应的服务。注意需要用路由器默认 dns，否则 hosts 不会生效。</p><p>看看部署好的服务吧：</p><p>netdata 监控服务</p><figure><img src="`+o+'" alt="2020-05-31T214154" tabindex="0" loading="lazy"><figcaption>2020-05-31T214154</figcaption></figure><p>aria2 下载服务</p><figure><img src="'+l+'" alt="2020-05-31T214257" tabindex="0" loading="lazy"><figcaption>2020-05-31T214257</figcaption></figure><p>百度网盘服务</p><figure><img src="'+c+'" alt="2020-05-31T220348" tabindex="0" loading="lazy"><figcaption>2020-05-31T220348</figcaption></figure><p>文件浏览服务</p><figure><img src="'+h+'" alt="2020-05-31T215710" tabindex="0" loading="lazy"><figcaption>2020-05-31T215710</figcaption></figure><p>到此就可以愉快的玩耍啦</p><p>Docker 配置和操作请参考：<a href="https://docs.docker.com/reference/" target="_blank" rel="noreferrer">https://docs.docker.com/reference/</a></p>',45)]))}const D=e(d,[["render",k]]);export{y as __pageData,D as default};
