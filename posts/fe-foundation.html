<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>对于前端工程的思考</title>
    <meta name="description" content="A VitePress site">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.EzQvn9cq.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.ClZH0l0l.js"></script>
    <link rel="modulepreload" href="/assets/chunks/theme.CyhJ7EsG.js">
    <link rel="modulepreload" href="/assets/chunks/framework.CAaOUjTN.js">
    <link rel="modulepreload" href="/assets/posts_fe-foundation.md.CMfN4UpI.lean.js">
    <meta name="rss" content="/rss.xml">
    <link href="/rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta name="date" content="2021-12-14T02:47:47.000Z">
  </head>
  <body>
    <div id="app"><div class="w-full flex flex-col xl:flex-row" data-v-acf221f1><div class="left flex-1 text-right" id="layout-content-left" data-v-acf221f1><div class="h-12 xl:h-screen sidebar" data-v-acf221f1><div class="flex items-center border-b border-gray-100 gap-2 px-4 bg-bGray-50 w-full xl:h-full xl:w-72 xl:border-r xl:border-gray-100 xl:flex-col xl:px-6 xl:pb-10 xl:overflow-auto"><a href="/" class="rounded-full overflow-hidden h-2/3 xl:h-4/5 xl:h-auto xl:w-4/5 xl:mt-20"><img class="transition duration-1000 rotate-0 hover:rotate-360 w-full h-full object-cover aspect-1" src="https://avatars.githubusercontent.com/u/14226737?v=4"></a><div class="tools py-2 w-full justify-center hidden xl:flex"><!----></div><div class="text-xl whitespace-nowrap flex-1 xl:flex-none xl:text-3xl">0x-Jerry</div><div class="hidden text-bGray-400 text-xs flex-1 flex-shrink-10 xl:block xl:my-2 xl:flex-none">Life was like a box of chocolates. You never know what you're gonna get.</div><div class="xl:mt-2"><!--[--><a href="https://github.com/0x-jerry" target="_blank"><i class="i-logos-github-icon"></i></a><!--]--></div><div class="gap-2 hidden sm:flex xl:flex-col xl:w-full"><!--[--><a href="/"><button class="p-2 border-gray-100 border-1 border-solid cursor-pointer bg-bGray-1 hover:bg-bGray-2 inline-flex items-center justify-center w-full pointer-events-none"><!--[--><i class="i-carbon-home"></i><span class="flex-1 hidden xl:inline-block">Home</span><!--]--></button></a><a href="/tags"><button class="p-2 border-gray-100 border-1 border-solid cursor-pointer bg-bGray-1 hover:bg-bGray-2 inline-flex items-center justify-center w-full pointer-events-none"><!--[--><i class="i-carbon-tag"></i><span class="flex-1 hidden xl:inline-block">Tags</span><!--]--></button></a><a href="/about"><button class="p-2 border-gray-100 border-1 border-solid cursor-pointer bg-bGray-1 hover:bg-bGray-2 inline-flex items-center justify-center w-full pointer-events-none"><!--[--><i class="i-carbon-user"></i><span class="flex-1 hidden xl:inline-block">About me</span><!--]--></button></a><a href="/search"><button class="p-2 border-gray-100 border-1 border-solid cursor-pointer bg-bGray-1 hover:bg-bGray-2 inline-flex items-center justify-center w-full pointer-events-none"><!--[--><i class="i-carbon-search"></i><span class="flex-1 hidden xl:inline-block">Search</span><!--]--></button></a><!--]--></div></div></div></div><div class="flex flex-col min-h-screen px-2 xl:px-0 w-700px max-w-full mx-auto xl:mx-0" data-v-acf221f1><div class="flex-1" data-v-acf221f1><!--[--><div class="v-post" data-v-3584d80f><div class="pt-3 sticky top-0 bg-white pb-2 border-0 border-b border-solid border-gray-2 z-1" data-v-3584d80f><div class="flex items-center gap-3 text-xl xl:text-2xl"><a class="cursor-pointer flex"><span class="inline-flex text-lg bg-bGray-100 p-1 rounded"><i class="i-carbon-arrow-left"></i></span></a><!--[-->对于前端工程的思考<!--]--></div></div><div class="flex mt-4" data-v-3584d80f><div class="post-content flex-1 w-0 px-4 xl:px-2" data-v-3584d80f><div class="heti text-left max-w-full" data-v-3584d80f><div style="position:relative;" data-v-3584d80f><div><p><em>此文，仅是自己对过去的一个梳理，其中的 <strong>最佳实践</strong> 和 <strong>总结</strong> 并不一定 <strong>正确</strong>，请酌情阅读，也欢迎讨论。</em></p><p>在当前的公司也有差不多两年了，项目接触了差不多十几个，自己搭建的项目也有不少。纵观之前接手的项目，以及现在的新项目， 多多少少有点沉淀，写一写，记一记。</p><p>因为公司没有架构师，而且前前后后接触了几个项目组，每个项目组都有自己的风格。有的用 Vue， 有的用 React，还有一些老项目 用的 jQuery 那一套。</p><h2 id="起因" tabindex="-1">起因 <a class="header-anchor" href="#起因" aria-label="Permalink to &quot;起因&quot;">​</a></h2><p>因为接触的项目多了，做的事情自然有一些重复的，而于我个人来讲，最烦的事情莫过于同样的事情做三遍。</p><p>于此，记一记关于 <strong>工程项目</strong> 相关的思考。包括：</p><ol><li>规范，包括项目结构规范，代码规范，前后端协议（接口）规范</li><li>项目编译，如 Webpack 等编译工具</li><li>持续集成，包括自动化测试，发布，回滚</li></ol><h2 id="规范" tabindex="-1">规范 <a class="header-anchor" href="#规范" aria-label="Permalink to &quot;规范&quot;">​</a></h2><p>规范，一定是根据项目一直在变的，只是变动不会特别大，也不会特别频繁。</p><p>对规范目的的思考。我认为规范的目的是为了让一个项目，中途换一拨人来继续开发，也能很快上手。换句话是，也就是提高项目的维护性。</p><h3 id="项目规范" tabindex="-1">项目规范 <a class="header-anchor" href="#项目规范" aria-label="Permalink to &quot;项目规范&quot;">​</a></h3><p>基于自身的经历，捋一捋项目的规范。基本都在做业务相关的代码，所以，本篇所说的项目，也就是指业务型项目。</p><p>基于一个业务，本身包含基础的结构，例如无论使用的是什么框架，都会包含例如 <code>api/utils/components</code> 等通用的结构。在此之上，再添加其他目录结构。</p><p>对于 <code>components</code>，我倾向于分为 <code>components</code> 和 <code>biz-components</code>，前者表示通用组件（与业务无关），后者表示业务共享组件，主要用于复用业务逻辑。</p><p>除了基础结构，还可以添加 <code>lib</code> 目录，用于一些自己沉淀的无关业务的相关库，其作用和 <code>utils</code> 类似，只不过代码量比 <code>utils</code> 要大一些， 通常是一整块逻辑。<code>utils</code> 适合放一些小函数（代码不超过 30 行）。</p><p>另外的一些规范，可根据具体的框架和工具链进行调整。例如基于 <a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a> 工具链的开源模板 <a href="https://github.com/antfu/Vitesse" target="_blank" rel="noreferrer">Vitesse</a>。</p><p>其实具体的目录名称倒并不是特别的重要，重要的是，要有这些规范，且要根据项目，适当的增加规范。这样，写或者看代码的人，才知道对应的代码，放什么位置。</p><h3 id="代码规范" tabindex="-1">代码规范 <a class="header-anchor" href="#代码规范" aria-label="Permalink to &quot;代码规范&quot;">​</a></h3><p>个人认为，能避免错误的代码风格约束一定要有，至于其他的约束，最好配合代码格式化程序，例如 <a href="https://github.com/Standard/ESLint-config-Standard" target="_blank" rel="noreferrer">ESLint-Standard</a> + <a href="https://github.com/Prettier/ESLint-config-Prettier" target="_blank" rel="noreferrer">ESLint-Prettier</a></p><p>这一块，主要目的有两个：</p><ol><li>避免低级错误，在错误出现之前，就发现错误</li><li>格式化之后的代码，更好看</li></ol><h3 id="前后端之间的规范" tabindex="-1">前后端之间的规范 <a class="header-anchor" href="#前后端之间的规范" aria-label="Permalink to &quot;前后端之间的规范&quot;">​</a></h3><p>这一块并不好定制，因为业务时常再变，有时候，甚至要直接调用第三方的服务，并不直接对接我们自己的后端。</p><p>这个时候，建议利用 <code>axios</code> 的 <code>interceptors</code>，统一一下，相关的响应参数。</p><p>对于这一块规范，主要需要明确的是怎么处理错误码，以及错误信息。</p><h2 id="项目编译" tabindex="-1">项目编译 <a class="header-anchor" href="#项目编译" aria-label="Permalink to &quot;项目编译&quot;">​</a></h2><p>这两年，编译工具领域可谓是百花齐放，<a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a>，<a href="https://ESBuild.github.io/" target="_blank" rel="noreferrer">ESBuild</a>, <a href="https://SWC.rs/" target="_blank" rel="noreferrer">SWC</a>, <a href="https://github.com/rome/tools" target="_blank" rel="noreferrer">rome</a> 这些工具一起冒了出来。 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 也更新到 5.x，一堆破坏性的变更。总算是加上了一堆默认配置，可以开箱即用（但是感觉很鸡肋）。 简单介绍一下，这些工具</p><ul><li><a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a>，一个新起之秀，基于 <a href="https://ESBuild.github.io/" target="_blank" rel="noreferrer">ESBuild</a> + <a href="https://rollupjs.org/" target="_blank" rel="noreferrer">Rollup</a> 的编译工具</li><li><a href="https://ESBuild.github.io/" target="_blank" rel="noreferrer">ESBuild</a>，一个基于 Golang 的 <code>js/ts</code> 编译器，功能与 <code>Babel/Rollup</code> 相同</li><li><a href="https://SWC.rs/" target="_blank" rel="noreferrer">SWC</a>，一个基于 Rust 的 <code>js/ts</code> 编译器，功能与 <code>Babel/Rollup</code> 相同</li><li><a href="https://github.com/rome/tools" target="_blank" rel="noreferrer">rome</a>，一个新的前端工程工具链，目标是集成所有前端用到的工具，可以理解成，集成 <code>Webpack/ESLint/Prettier</code> 等这些工具的功能于一体，目前正在用 <code>Rust</code> 重写（个人不是特别看好）</li></ul><p>在这些工具出来之前，有一个开玩笑的职称叫 <strong>Webpack 配置工程师</strong>，可见 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 的配置还是很复杂的。</p><p>在此，讲讲我与 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 5.x 的故事，在 <a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a> 刚出来的时候，<a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 也更新到了 5.x，当时公司的项目都还是用的 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 4.x。 我的一个业余目标，就是想统一一下公司的打包工具，公司之前的项目，都是一个项目一个 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 配置，就想写一个库支持打包所有的项目，就当练手。借此机会，研究了一下 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 5.x 的并写了一个 <code>xxx-compile</code>（脱敏处理一下） 的内部工具，开箱支持 <code>TS/Vue/React</code>，以及热更新。</p><p>说着也巧，正是在我差不多写完这个库之后，<a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a> 1.0 出来了！之后，开始接触 <a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a>，真香！今年 10 月左右的时候，换了一个项目组，接手了几个新项目， 看到是新项目，接手的第一件事情，就是把项目从 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 切换到 <a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a>。真香！</p><p>从我的经历来看，<a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a> 的配置相比 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 要简单很多。</p><p>但即使是这样，我也更倾向于使用类似 <a href="https://parceljs.org/" target="_blank" rel="noreferrer">Parcel</a> 这样的一键打包工具。为什么没选 <a href="https://parceljs.org/" target="_blank" rel="noreferrer">Parcel</a> 呢？因为定制天花板不是特别高。</p><p>基于此，我更倾向于，公司基于 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 或者 <a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a> 这样的工具，自己封装一个编译工具，自己根据规范抽象一套配置。 封装的编译工具也能根据规范去实现对应的功能，这样就几乎不需要配置项。</p><p>为什么要抽象一套配置，而不是基于已有的 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 配置或者 <a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a> 配置。支持抽象一套配置的好处有两点：</p><ol><li>因为是根据规范抽象的配置，所以配置应当非常简单，最好是不需要配置</li><li>将来如果要更换编译工具，例如从 <a href="https://Webpack.js.org/" target="_blank" rel="noreferrer">Webpack</a> 切换到 <a href="https://Vitejs.dev" target="_blank" rel="noreferrer">Vite</a>，项目不需要做大的更新，只需更新一下封装的编译工具即可</li></ol><h2 id="持续集成" tabindex="-1">持续集成 <a class="header-anchor" href="#持续集成" aria-label="Permalink to &quot;持续集成&quot;">​</a></h2><p>一个项目一定要有一个自动化相关的辅助系统，例如 <code>Github Actions</code></p><p>必要的相关集成：</p><ol><li>自动化测试</li><li>测试环境自动部署</li><li>发布控制</li><li>回滚控制</li></ol><p>可选的集成</p><ol><li>金丝雀发布</li></ol><p>虽然上面说的是必要的，但其实也可以都没有。毕竟前端的发布，都是一些静态资源，并没有后端那么多需要注意的点。</p><p>测试代码也可以直接在本地跑一遍。如果能集成在一起，当然是最好的。</p><p>关于这一块，之后整理一个基于 Docker 搭建的一系列内网服务，再仔细记录一下。</p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>最后记录一下，目前自己的最佳实践吧，基于 <a href="https://github.com/antfu/Vitesse" target="_blank" rel="noreferrer">Vitesse</a> 改造的模板：<a href="https://github.com/0x-jerry/project-v" target="_blank" rel="noreferrer">project-v</a></p></div></div><div class="pt-6" data-v-3584d80f><div class="text-center c-bPrimary-2 text-6xl relative" data-v-3584d80f><span data-v-3584d80f> 完 </span><span class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 inline-block size-1.8em border-2 border-dashed border-bPrimary-1 rounded-full" data-v-3584d80f></span></div></div></div><br data-v-3584d80f><!----></div><!----></div></div><!--]--></div><div class="mt-6" data-v-acf221f1><div class="w-full text-center mt-4 my-6" data-v-acf221f1> © 2017-2025 @ 0x-Jerry. Built top on <a class="link" title="https://vitepress.dev/" href="https://vitepress.dev/" target="_blank" data-v-afcd4aec><span data-v-afcd4aec><!--[--> Vitepress <!--]--></span></a> . </div></div></div><div class="right flex-1 hidden xl:block" id="layout-content-right" data-v-acf221f1></div></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"-TavtE4Q\",\"drafts_low-code.md\":\"khCRW8eF\",\"drafts_wave-function-collapse.md\":\"Q5z0Yc4l\",\"drafts_write-a-business-page.md\":\"DJ_SRLOT\",\"index.md\":\"Jvv52zHL\",\"posts_baisc-git.md\":\"nDe1nFNd\",\"posts_base64-and-blob.md\":\"C4tvfrKo\",\"posts_basic-ajax.md\":\"BVS2ccKC\",\"posts_basic-hexo.md\":\"DgbOcA4h\",\"posts_basic-nuxtjs.md\":\"DBVZw-4_\",\"posts_cloudflare-and-github-pages.md\":\"CWq-47l-\",\"posts_cocker-compile-scratchblocks.md\":\"CV2c7rN9\",\"posts_design-blog-system-2.md\":\"DZ3ivYwq\",\"posts_design-blog-system-3.md\":\"DoB91O3l\",\"posts_design-blog-system-4.md\":\"CSzOZHhh\",\"posts_design-blog-system.md\":\"DW_MDupZ\",\"posts_design-reuse-system.md\":\"DfmocIhn\",\"posts_docker-on-raspberrypi.md\":\"DkAazsLm\",\"posts_encrypt-workspace.md\":\"C9bVnvxf\",\"posts_fe-foundation.md\":\"CMfN4UpI\",\"posts_first-page.md\":\"B6sJQiIz\",\"posts_grpc.md\":\"BjvP4POz\",\"posts_hexo-git-and-travis.md\":\"DECR__jh\",\"posts_inode.md\":\"D1WIcIu0\",\"posts_intro-webassembly.md\":\"BpjFHPm1\",\"posts_js-ci.md\":\"2sUEccG1\",\"posts_l-system.md\":\"D-wBxIbL\",\"posts_machine-learning.md\":\"kkOEOjxr\",\"posts_micro-frontend.md\":\"Dd9C_Ty5\",\"posts_middle-of-2024.md\":\"DXYqcGMl\",\"posts_nginx-with-location.md\":\"Dy752-cR\",\"posts_node-best-practice.md\":\"COEOXh3o\",\"posts_regexp.md\":\"HLzci60x\",\"posts_render-line.md\":\"DakZ4pho\",\"posts_tech-and-content.md\":\"BO3wMr_M\",\"posts_ubuntu-app.md\":\"pld2-kWt\",\"posts_v2ray_nginx_https.md\":\"BXIG1rPR\",\"posts_vitepress-mismatch.md\":\"CC8QH-Jw\",\"posts_vue-reactivity.md\":\"Cv3xxytv\",\"posts_vue-runtime-core.md\":\"CMMn83VS\",\"posts_vue-runtime-dom.md\":\"OkU2Gybu\",\"readme.md\":\"Bvu62HrZ\",\"search.md\":\"D__KYlbb\",\"tags.md\":\"CFhKBdnE\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"0x-Jerry\",\"titleTemplate\":\":title\",\"description\":\"A VitePress site\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"name\":\"0x-Jerry\",\"avatar\":\"https://avatars.githubusercontent.com/u/14226737?v=4\",\"motto\":\"Life was like a box of chocolates. You never know what you're gonna get.\",\"email\":\"x.jerry.wang@gmail.com\",\"timezone\":\"Asia/Chongqing\",\"links\":{\"github\":\"https://github.com/0x-jerry\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>